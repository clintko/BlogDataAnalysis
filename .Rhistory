library(dplyr)
resMat
resMat %>% arrange(V1) %>% View
plot(resMat$V1, resMat$V2)
resMat$V1
plot(log10(resMat$V1), resMat$V2)
plot(-log10(resMat$V1), resMat$V2)
seq(10, 90, by=10)
resMat <- matrix(c(0, 0), nrow=1)
resMat
for (red in seq(10, 90, by=10)){
print("-----------------------------------------")
print(paste("RED Total:", red))
for(getRed in 1:(min(pick,red)-1)){
mat <- getMatrix(getRed, pick, red, white)
res <- fisher.test(mat, alternative = "less")
resMat <- rbind(resMat, matrix(c(1-res$p.value, res$estimate),nrow=1))
print(paste("Red:",getRed, "",
"PValue:", 1-res$p.value, "",
"OR:",     res$estimate))
}
print("-----------------------------------------")
}
resMat <- resMat[-1,]
resMat <- as.data.frame(resMat)
library(dplyr)
resMat %>% arrange(V1) %>% View
plot(-log10(resMat$V1), resMat$V2)
dat <- resMat
plot(-log10(dat$V1), dat$V2)
dat <- resMat %>% filter(V2 <50)
head(dat)
plot(-log10(dat$V1), dat$V2)
library(AnnotationHub)
install.packages("AnnotationHub")
source("https://bioconductor.org/biocLite.R")
biocLite("AnnotationHub")
library(AnnotationHub)
hub <- AnnotationHub()
query(hub, "Cricetulus")
Cgriseus <- hub[["AH48061"]]
Cgriseus <- hub[["AH52157"]]
Cgriseus
library(clusterProfiler)
sample_gene <- sample(keys(Cgriseus), 100)
str(sample_gene)
library(clusterProfiler)
sample_test <- enrichGO(
sample_gene,
OrgDb=Cgriseus,
pvalueCutoff=1,
qvalueCutoff=1)
head(summary(sample_test))
head(summary(sample_test))
head(summary(sample_test))
View(head(summary(sample_test)))
library(org.Hs.eg.db)
data(geneList)
gene <- names(geneList)[abs(geneList) > 2]
gene.df <- bitr(gene, fromType = "ENTREZID",
toType = c("ENSEMBL", "SYMBOL"),
OrgDb = org.Hs.eg.db)
head(gene.df)
ego <- enrichGO(gene          = gene,
universe      = names(geneList),
OrgDb         = org.Hs.eg.db,
ont           = "CC",
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05)
head(summary(ego))
View(head(summary(ego3)))
View(head(summary(ego)))
ego2 <- enrichGO(gene        = gene.df$ENSEMBL,
OrgDb        = org.Hs.eg.db,
keytype      = 'ENSEMBL',
ont          = "CC",
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05)
head(summary(ego2))
ego3 <- enrichGO(gene         = gene.df$SYMBOL,
OrgDb         = org.Hs.eg.db,
keytype       = 'SYMBOL',
ont           = "CC",
pAdjustMethod = "BH",
pvalueCutoff  = 0.01,
qvalueCutoff  = 0.05)
head(summary(ego3))
#View(head(summary(ego3)))
head(ego)
head(setReadable(ego, OrgDb = org.Hs.eg.db))
ego <- setReadable(ego, OrgDb = org.Hs.eg.db)
ego2 <- setReadable(ego2, OrgDb = org.Hs.eg.db)
dotplot(ego, showCategory=30)
enrichMap(ego, vertex.label.cex=1.2, layout=igraph::layout.kamada.kawai)
cnetplot(ego, foldChange=geneList)
plotGOgraph(ego)
install.packages("topGO")
biocLite("topGO")
plotGOgraph(ego)
install.packages("Rgraphviz")
biocLite("Rgraphviz")
plotGOgraph(ego)
# A plotting R script produced by the REVIGO server at http://revigo.irb.hr/
# If you found REVIGO useful in your work, please cite the following reference:
# Supek F et al. "REVIGO summarizes and visualizes long lists of Gene Ontology
# terms" PLoS ONE 2011. doi:10.1371/journal.pone.0021800
# --------------------------------------------------------------------------
# If you don't have the ggplot2 package installed, uncomment the following line:
# install.packages( "ggplot2" );
library( ggplot2 );
# --------------------------------------------------------------------------
# If you don't have the scales package installed, uncomment the following line:
# install.packages( "scales" );
library( scales );
# --------------------------------------------------------------------------
# Here is your data from REVIGO. Scroll down for plot configuration options.
revigo.names <- c("term_ID","description","frequency_%","plot_X","plot_Y","plot_size","log10_p_value","uniqueness","dispensability");
revigo.data <- rbind(c("GO:0007155","cell adhesion", 0.564,-0.668,-0.798, 5.448,-21.1024,0.953,0.000),
c("GO:0008104","protein localization", 1.716, 0.932,-2.933, 5.931,-16.7852,0.857,0.000),
c("GO:0009611","response to wounding", 0.111, 2.399,-4.080, 4.744,-11.6946,0.922,0.000),
c("GO:0016032","viral process", 1.744, 0.141, 1.303, 5.938,-17.1296,0.902,0.000),
c("GO:0019882","antigen processing and presentation", 0.131, 0.192, 0.149, 4.814,-4.3270,0.959,0.000),
c("GO:0022610","biological adhesion", 1.210,-0.832, 0.370, 5.780,-21.4260,0.994,0.000),
c("GO:0040011","locomotion", 1.437,-0.439, 0.141, 5.854,-10.5702,0.994,0.000),
c("GO:0044085","cellular component biogenesis", 3.213,-7.748, 0.321, 6.204,-17.6383,0.788,0.000),
c("GO:0006928","movement of cell or subcellular component", 0.492, 0.034, 0.791, 5.389,-15.8827,0.913,0.030),
c("GO:0006412","translation", 4.698, 3.052, 1.526, 6.369,-14.0438,0.887,0.040),
c("GO:0003012","muscle system process", 0.020,-2.501, 1.675, 4.006,-8.2472,0.840,0.041),
c("GO:0061028","establishment of endothelial barrier", 0.001,-4.191, 3.373, 2.822,-5.0292,0.777,0.061),
c("GO:0043603","cellular amide metabolic process", 0.910, 1.775, 3.434, 5.656,-11.1090,0.931,0.074),
c("GO:0001775","cell activation", 0.048,-0.443, 0.196, 4.377,-2.2912,0.925,0.078),
c("GO:0030029","actin filament-based process", 0.077,-0.342, 0.191, 4.582,-8.0570,0.923,0.081),
c("GO:0042981","regulation of apoptotic process", 0.129,-0.915,-7.053, 4.806,-3.3279,0.825,0.084),
c("GO:0007017","microtubule-based process", 0.172,-0.293, 0.519, 4.932,-1.7830,0.919,0.086),
c("GO:0006090","pyruvate metabolic process", 0.725, 1.988, 2.688, 5.557,-6.6925,0.872,0.098),
c("GO:0000184","nuclear-transcribed mRNA catabolic process, nonsense-mediated decay", 0.004, 2.392, 3.418, 3.337,-13.7471,0.899,0.137),
c("GO:0048660","regulation of smooth muscle cell proliferation", 0.003,-1.086,-6.208, 3.227,-1.9795,0.883,0.203),
c("GO:0043604","amide biosynthetic process", 0.553, 2.710, 3.748, 5.439,-12.7721,0.912,0.220),
c("GO:0019674","NAD metabolic process", 0.254, 3.855, 3.173, 5.101,-5.6162,0.820,0.221),
c("GO:0016072","rRNA metabolic process", 0.763, 3.815, 4.377, 5.579,-7.5751,0.897,0.230),
c("GO:0051235","maintenance of location", 0.029, 0.068,-7.654, 4.164,-2.1710,0.852,0.232),
c("GO:0072524","pyridine-containing compound metabolic process", 0.890, 2.139, 3.295, 5.646,-3.6819,0.915,0.245),
c("GO:0046031","ADP metabolic process", 0.002, 3.452, 2.700, 3.017,-3.8601,0.868,0.250),
c("GO:0034975","protein folding in endoplasmic reticulum", 0.000, 1.380,-0.400, 1.869,-2.0342,0.949,0.269),
c("GO:1902580","single-organism cellular localization", 0.296, 0.952,-2.793, 5.168,-12.5482,0.822,0.286),
c("GO:0016192","vesicle-mediated transport", 0.381, 1.008,-2.664, 5.277,-11.4949,0.923,0.294),
c("GO:0048870","cell motility", 0.402, 1.626,-2.728, 5.301,-8.0926,0.777,0.295),
c("GO:0051674","localization of cell", 0.402, 0.892,-2.345, 5.301,-8.0926,0.923,0.295),
c("GO:0009057","macromolecule catabolic process", 1.643, 3.312, 4.020, 5.912,-5.5719,0.909,0.304),
c("GO:0071495","cellular response to endogenous stimulus", 0.091, 1.980,-2.779, 4.656,-2.6078,0.924,0.321),
c("GO:0002181","cytoplasmic translation", 0.003, 2.110, 0.350, 3.139,-2.0146,0.933,0.327),
c("GO:0006082","organic acid metabolic process", 9.359, 2.145, 2.961, 6.668,-1.6730,0.846,0.331),
c("GO:0009132","nucleoside diphosphate metabolic process", 0.153, 4.180, 3.329, 4.881,-2.6862,0.853,0.335),
c("GO:0016071","mRNA metabolic process", 0.494, 3.674, 4.298, 5.391,-2.9105,0.904,0.337),
c("GO:1903337","positive regulation of vacuolar transport", 0.000,-0.548,-6.195, 0.301,-1.8752,0.821,0.344),
c("GO:0051641","cellular localization", 1.638, 0.914,-2.413, 5.911,-16.4365,0.915,0.346),
c("GO:0010033","response to organic substance", 0.287, 2.394,-3.948, 5.155,-5.5735,0.893,0.350),
c("GO:0009719","response to endogenous stimulus", 0.113, 2.190,-3.542, 4.750,-2.7998,0.930,0.350),
c("GO:0046939","nucleotide phosphorylation", 0.262, 4.479, 3.323, 5.114,-3.3089,0.841,0.351),
c("GO:0033036","macromolecule localization", 1.969, 1.022,-2.682, 5.991,-14.3401,0.913,0.354),
c("GO:0010608","posttranscriptional regulation of gene expression", 0.537, 0.226,-6.917, 5.427,-1.7463,0.855,0.360),
c("GO:1901566","organonitrogen compound biosynthetic process", 9.297, 3.108, 4.483, 6.665,-9.1221,0.918,0.370),
c("GO:0007264","small GTPase mediated signal transduction", 0.234, 0.722,-7.668, 5.067,-2.4947,0.783,0.372),
c("GO:0009201","ribonucleoside triphosphate biosynthetic process", 0.590, 4.312, 3.843, 5.467,-1.5964,0.820,0.376),
c("GO:0048168","regulation of neuronal synaptic plasticity", 0.003,-0.880,-6.839, 3.108,-1.3827,0.855,0.377),
c("GO:0016310","phosphorylation", 6.300, 3.675, 1.759, 6.496,-1.9580,0.897,0.378),
c("GO:0051174","regulation of phosphorus metabolic process", 0.392, 0.569,-5.777, 5.290,-1.6900,0.833,0.381),
c("GO:0034976","response to endoplasmic reticulum stress", 0.011, 2.698,-4.864, 3.742,-2.4273,0.908,0.385),
c("GO:0046777","protein autophosphorylation", 0.022, 3.243, 1.221, 4.038,-2.4482,0.900,0.386),
c("GO:0051291","protein heterooligomerization", 0.003,-7.653, 0.346, 3.114,-3.2076,0.824,0.394),
c("GO:0050790","regulation of catalytic activity", 0.651,-0.830,-7.696, 5.510,-1.3418,0.882,0.400),
c("GO:0010737","protein kinase A signaling", 0.001, 0.990,-7.812, 2.759,-1.8752,0.839,0.402),
c("GO:0042060","wound healing", 0.025, 2.603,-4.750, 4.087,-11.7595,0.922,0.405),
c("GO:0034660","ncRNA metabolic process", 3.209, 3.153, 3.217, 6.203,-5.4634,0.887,0.412),
c("GO:0034329","cell junction assembly", 0.009,-7.796, 0.346, 3.652,-8.4179,0.784,0.432),
c("GO:0043456","regulation of pentose-phosphate shunt", 0.000, 4.308, 0.398, 0.477,-1.6392,0.813,0.434),
c("GO:0034330","cell junction organization", 0.011,-7.621, 0.397, 3.751,-10.8928,0.804,0.440),
c("GO:0090066","regulation of anatomical structure size", 0.042,-0.813,-7.910, 4.324,-1.6556,0.894,0.442),
c("GO:0031952","regulation of protein autophosphorylation", 0.002, 1.957,-4.918, 2.927,-2.5153,0.842,0.450),
c("GO:0030198","extracellular matrix organization", 0.015,-7.577, 0.358, 3.884,-8.3840,0.795,0.451),
c("GO:0043062","extracellular structure organization", 0.016,-7.557, 0.359, 3.889,-8.3655,0.800,0.452),
c("GO:1902946","protein localization to early endosome", 0.000, 0.748,-2.287, 2.097,-1.4900,0.879,0.454),
c("GO:0002576","platelet degranulation", 0.001, 0.831,-2.365, 2.493,-2.0978,0.845,0.454),
c("GO:0007167","enzyme linked receptor protein signaling pathway", 0.063, 0.618,-7.503, 4.494,-2.3517,0.799,0.468),
c("GO:0010256","endomembrane system organization", 0.029,-7.209, 0.185, 4.156,-2.6289,0.823,0.476),
c("GO:0032535","regulation of cellular component size", 0.030,-6.025,-4.059, 4.178,-1.5335,0.729,0.478),
c("GO:0010959","regulation of metal ion transport", 0.040,-0.072,-7.028, 4.303,-1.4026,0.809,0.485),
c("GO:0042273","ribosomal large subunit biogenesis", 0.037,-7.375, 0.237, 4.264,-1.6217,0.836,0.486),
c("GO:0006396","RNA processing", 2.784, 3.389, 3.174, 6.141,-1.9644,0.882,0.488),
c("GO:0061621","canonical glycolysis", 0.000, 3.790, 4.213, 1.447,-4.5751,0.839,0.489),
c("GO:0006413","translational initiation", 0.267, 2.701, 1.071, 5.123,-12.3107,0.910,0.494),
c("GO:0051130","positive regulation of cellular component organization", 0.053,-5.876,-4.117, 4.422,-5.2933,0.718,0.502),
c("GO:0006890","retrograde vesicle-mediated transport, Golgi to ER", 0.004, 0.969,-2.847, 3.318,-6.4330,0.845,0.509),
c("GO:0021762","substantia nigra development", 0.003,-3.635, 2.552, 3.154,-1.3573,0.770,0.511),
c("GO:0016052","carbohydrate catabolic process", 1.351, 2.430, 4.737, 5.827,-1.8848,0.900,0.512),
c("GO:0032963","collagen metabolic process", 0.003,-2.072, 1.512, 3.219,-2.7322,0.831,0.515),
c("GO:0045815","positive regulation of gene expression, epigenetic", 0.001,-0.594,-6.954, 2.640,-1.3636,0.873,0.516),
c("GO:0001895","retina homeostasis", 0.004,-2.165,-5.446, 3.257,-2.2931,0.789,0.517),
c("GO:0044236","multicellular organismal metabolic process", 0.004,-2.398, 1.485, 3.340,-2.2364,0.845,0.522),
c("GO:0044089","positive regulation of cellular component biogenesis", 0.002,-6.296,-3.883, 2.968,-2.4260,0.781,0.537),
c("GO:1902031","regulation of NADP metabolic process", 0.000, 2.601,-1.935, 0.477,-1.3824,0.850,0.538),
c("GO:0006007","glucose catabolic process", 0.399, 2.423, 3.999, 5.297,-4.1385,0.850,0.540),
c("GO:0006734","NADH metabolic process", 0.000, 3.254, 2.586, 2.283,-4.8601,0.876,0.541),
c("GO:0044087","regulation of cellular component biogenesis", 0.127,-6.134,-4.152, 4.802,-3.0209,0.756,0.546),
c("GO:0000165","MAPK cascade", 0.054, 2.876,-5.443, 4.425,-2.0452,0.754,0.547),
c("GO:0090130","tissue migration", 0.012,-1.905, 1.219, 3.783,-1.3507,0.846,0.553),
c("GO:0007010","cytoskeleton organization", 0.151,-7.408, 0.250, 4.876,-8.5575,0.796,0.555),
c("GO:0034248","regulation of cellular amide metabolic process", 0.001,-0.668,-5.789, 2.732,-3.1838,0.879,0.560),
c("GO:0050817","coagulation", 0.016,-2.393, 1.489, 3.889,-7.1331,0.844,0.561),
c("GO:0060333","interferon-gamma-mediated signaling pathway", 0.001, 0.988,-6.655, 2.767,-2.0179,0.778,0.561),
c("GO:0007166","cell surface receptor signaling pathway", 0.621, 0.761,-7.424, 5.490,-1.5832,0.768,0.565),
c("GO:0034109","homotypic cell-cell adhesion", 0.004,-0.669,-0.786, 3.284,-10.1851,0.920,0.569),
c("GO:0051656","establishment of organelle localization", 0.023, 0.849,-2.506, 4.060,-1.7769,0.878,0.570),
c("GO:0050878","regulation of body fluid levels", 0.022,-2.026,-6.399, 4.040,-5.8356,0.768,0.572),
c("GO:0001503","ossification", 0.025,-2.320, 1.477, 4.097,-2.3545,0.840,0.579),
c("GO:0001649","osteoblast differentiation", 0.013,-3.820, 2.729, 3.806,-3.6364,0.732,0.580),
c("GO:0032268","regulation of cellular protein metabolic process", 0.691, 0.851,-7.148, 5.536,-1.5637,0.821,0.588),
c("GO:0031344","regulation of cell projection organization", 0.042,-6.399,-4.188, 4.324,-2.9508,0.711,0.593),
c("GO:1901698","response to nitrogen compound", 0.042, 2.926,-5.016, 4.319,-1.4431,0.905,0.597),
c("GO:0070208","protein heterotrimerization", 0.001,-7.601, 0.405, 2.594,-1.9555,0.834,0.600),
c("GO:0010810","regulation of cell-substrate adhesion", 0.009,-1.152,-6.218, 3.636,-5.5003,0.860,0.600),
c("GO:0032507","maintenance of protein location in cell", 0.016,-0.050,-6.842, 3.914,-2.5019,0.743,0.603),
c("GO:0030030","cell projection organization", 0.378,-7.229, 0.387, 5.274,-6.4584,0.755,0.611),
c("GO:0006887","exocytosis", 0.034, 1.073,-3.077, 4.231,-1.5159,0.808,0.614),
c("GO:0034655","nucleobase-containing compound catabolic process", 5.912, 3.241, 4.787, 6.468,-7.3778,0.855,0.621),
c("GO:0007229","integrin-mediated signaling pathway", 0.015, 0.680,-7.534, 3.870,-2.1205,0.815,0.624),
c("GO:0030155","regulation of cell adhesion", 0.021,-1.151,-6.486, 4.016,-5.0670,0.861,0.639),
c("GO:0031589","cell-substrate adhesion", 0.021,-0.633,-0.788, 4.023,-9.9508,0.954,0.640),
c("GO:0070271","protein complex biogenesis", 0.565,-7.828, 0.362, 5.449,-4.8477,0.806,0.640),
c("GO:0009199","ribonucleoside triphosphate metabolic process", 6.560, 4.196, 3.918, 6.514,-2.3734,0.792,0.641),
c("GO:0040012","regulation of locomotion", 0.055,-0.452,-6.733, 4.434,-5.1445,0.853,0.642),
c("GO:0098602","single organism cell adhesion", 0.023,-0.664,-0.787, 4.052,-8.2411,0.919,0.643),
c("GO:0006733","oxidoreduction coenzyme metabolic process", 0.807, 1.068, 1.640, 5.604,-3.4895,0.923,0.648),
c("GO:0006909","phagocytosis", 0.011, 0.858,-2.215, 3.754,-1.3954,0.887,0.651),
c("GO:0031346","positive regulation of cell projection organization", 0.010,-6.378,-4.199, 3.691,-1.5634,0.707,0.654),
c("GO:0098609","cell-cell adhesion", 0.030,-0.661,-0.801, 4.176,-16.6440,0.954,0.657),
c("GO:1990778","protein localization to cell periphery", 0.051, 0.956,-3.020, 4.400,-3.6861,0.852,0.661),
c("GO:0016051","carbohydrate biosynthetic process", 1.539, 2.655, 4.204, 5.884,-1.8184,0.869,0.661),
c("GO:0019220","regulation of phosphate metabolic process", 0.391, 1.337,-6.620, 5.289,-1.6930,0.820,0.668),
c("GO:0000902","cell morphogenesis", 0.841,-7.050, 1.918, 5.622,-7.5376,0.614,0.671),
c("GO:0030036","actin cytoskeleton organization", 0.073,-7.199, 0.204, 4.559,-5.6861,0.758,0.675),
c("GO:0071310","cellular response to organic substance", 0.211, 2.446,-3.989, 5.021,-4.4112,0.854,0.677),
c("GO:0042692","muscle cell differentiation", 0.022,-3.755, 3.074, 4.037,-2.3262,0.765,0.681),
c("GO:0061061","muscle structure development", 0.035,-3.812, 3.139, 4.247,-2.3707,0.810,0.682),
c("GO:0009142","nucleoside triphosphate biosynthetic process", 0.673, 4.438, 3.955, 5.525,-1.3471,0.819,0.684),
c("GO:0014812","muscle cell migration", 0.003, 1.217,-2.598, 3.122,-1.6217,0.831,0.685),
c("GO:0001568","blood vessel development", 0.037,-3.743, 2.649, 4.268,-4.8508,0.740,0.685),
c("GO:0051094","positive regulation of developmental process", 0.054,-3.621,-4.304, 4.428,-1.6206,0.732,0.686),
c("GO:0003008","system process", 0.199,-2.544, 1.686, 4.995,-1.8184,0.819,0.686),
c("GO:0061024","membrane organization", 1.009,-7.982, 0.399, 5.701,-13.0825,0.774,0.686),
c("GO:0051128","regulation of cellular component organization", 1.020,-5.808,-4.219, 5.705,-5.6968,0.699,0.687),
c("GO:0044033","multi-organism metabolic process", 0.226, 0.137, 1.160, 5.051,-11.2644,0.944,0.688),
c("GO:0043933","macromolecular complex subunit organization", 1.063,-7.575, 0.266, 5.723,-3.3344,0.773,0.691),
c("GO:0010035","response to inorganic substance", 0.273, 2.393,-3.943, 5.133,-1.4033,0.894,0.692),
c("GO:0006165","nucleoside diphosphate phosphorylation", 0.044, 4.556, 3.481, 4.336,-3.4949,0.837,0.699),
c("GO:0006402","mRNA catabolic process", 0.113, 3.211, 4.040, 4.752,-9.1938,0.877,0.699),
c("GO:0006614","SRP-dependent cotranslational protein targeting to membrane", 0.097,-6.103,-1.709, 4.682,-16.9318,0.646,0.700),
c("GO:0043254","regulation of protein complex assembly", 0.030,-6.037,-3.824, 4.175,-1.3296,0.730,0.701),
c("GO:0019080","viral gene expression", 0.073, 1.283, 1.116, 4.562,-12.1785,0.895,0.702),
c("GO:0006401","RNA catabolic process", 0.274, 3.408, 4.155, 5.135,-8.3028,0.870,0.702),
c("GO:0009135","purine nucleoside diphosphate metabolic process", 0.002, 3.376, 2.511, 3.072,-3.3335,0.875,0.704),
c("GO:0009185","ribonucleoside diphosphate metabolic process", 0.003, 3.317, 2.418, 3.099,-3.2757,0.875,0.706),
c("GO:0007009","plasma membrane organization", 0.011,-7.244, 0.231, 3.754,-4.0339,0.788,0.715),
c("GO:0044802","single-organism membrane organization", 0.320,-7.745, 0.696, 5.201,-11.2000,0.749,0.717),
c("GO:0048002","antigen processing and presentation of peptide antigen", 0.062, 0.206, 0.158, 4.487,-3.9830,0.954,0.719),
c("GO:0002495","antigen processing and presentation of peptide antigen via MHC class II", 0.002, 0.157, 0.188, 2.904,-2.3504,0.959,0.719),
c("GO:0022607","cellular component assembly", 1.474,-7.982, 0.381, 5.865,-11.1035,0.760,0.720),
c("GO:0065003","macromolecular complex assembly", 0.676,-7.711, 0.295, 5.527,-6.0511,0.757,0.722),
c("GO:0030968","endoplasmic reticulum unfolded protein response", 0.005, 0.767,-7.151, 3.363,-1.6396,0.783,0.723),
c("GO:0023014","signal transduction by protein phosphorylation", 1.074, 3.361,-4.788, 5.728,-1.8364,0.699,0.723),
c("GO:0006936","muscle contraction", 0.018,-1.915, 1.228, 3.947,-7.0052,0.840,0.725),
c("GO:0002478","antigen processing and presentation of exogenous peptide antigen", 0.002, 0.208, 0.257, 2.968,-3.6596,0.957,0.725),
c("GO:0060429","epithelium development", 0.078,-4.299, 3.624, 4.588,-3.0640,0.811,0.727),
c("GO:0070887","cellular response to chemical stimulus", 0.495, 2.545,-4.341, 5.392,-3.8962,0.863,0.729),
c("GO:0019884","antigen processing and presentation of exogenous antigen", 0.002, 0.181, 0.161, 3.015,-3.5045,0.960,0.730),
c("GO:0048193","Golgi vesicle transport", 0.044, 0.916,-2.627, 4.344,-5.8570,0.824,0.730),
c("GO:0031953","negative regulation of protein autophosphorylation", 0.001, 1.804,-4.862, 2.483,-2.2395,0.849,0.733),
c("GO:1901700","response to oxygen-containing compound", 0.312, 2.957,-5.126, 5.191,-2.3276,0.893,0.734),
c("GO:0072359","circulatory system development", 0.062,-4.089, 3.052, 4.488,-4.3251,0.739,0.736),
c("GO:0006935","chemotaxis", 0.336, 2.683,-4.336, 5.224,-2.6955,0.829,0.746),
c("GO:0042330","taxis", 0.337, 2.708,-4.345, 5.224,-2.6874,0.860,0.746),
c("GO:0000956","nuclear-transcribed mRNA catabolic process", 0.013, 3.416, 4.814, 3.814,-9.7520,0.892,0.748),
c("GO:0009119","ribonucleoside metabolic process", 7.925, 3.694, 4.907, 6.596,-1.6684,0.801,0.753),
c("GO:0042254","ribosome biogenesis", 1.029,-7.528, 0.244, 5.709,-7.6402,0.794,0.757),
c("GO:0051764","actin crosslink formation", 0.001,-7.639, 0.548, 2.611,-2.2395,0.800,0.757),
c("GO:0022613","ribonucleoprotein complex biogenesis", 1.055,-8.052, 0.410, 5.720,-7.4711,0.796,0.759),
c("GO:0035966","response to topologically incorrect protein", 0.010, 2.768,-4.800, 3.695,-1.4059,0.896,0.759),
c("GO:0071826","ribonucleoprotein complex subunit organization", 0.109,-8.042, 0.449, 4.732,-1.4854,0.793,0.760),
c("GO:0006732","coenzyme metabolic process", 2.742, 1.064, 1.645, 6.135,-1.8940,0.918,0.761),
c("GO:0048858","cell projection morphogenesis", 0.049,-7.033, 1.683, 4.383,-5.3279,0.664,0.762),
c("GO:0000904","cell morphogenesis involved in differentiation", 0.049,-7.190, 1.765, 4.391,-6.3516,0.650,0.763),
c("GO:0032990","cell part morphogenesis", 0.050,-7.099, 1.731, 4.395,-5.6021,0.678,0.764),
c("GO:0034470","ncRNA processing", 2.258, 3.870, 3.791, 6.050,-6.7595,0.881,0.768),
c("GO:0009141","nucleoside triphosphate metabolic process", 6.724, 4.292, 4.026, 6.524,-2.5902,0.796,0.768),
c("GO:0051259","protein oligomerization", 0.124,-7.964, 0.378, 4.789,-2.1353,0.781,0.769),
c("GO:1901361","organic cyclic compound catabolic process", 6.341, 2.961, 4.410, 6.499,-6.7799,0.891,0.771),
c("GO:0046364","monosaccharide biosynthetic process", 0.311, 2.255, 3.912, 5.190,-2.7926,0.876,0.771),
c("GO:0003158","endothelium development", 0.005,-3.541, 2.901, 3.381,-2.0168,0.836,0.774),
c("GO:0044265","cellular macromolecule catabolic process", 1.109, 3.565, 3.931, 5.742,-5.8570,0.879,0.777),
c("GO:1902582","single-organism intracellular transport", 0.461, 1.094,-3.453, 5.361,-10.1918,0.810,0.791),
c("GO:0006735","NADH regeneration", 0.000, 2.634, 2.479, 0.477,-4.5751,0.891,0.793),
c("GO:0007051","spindle organization", 0.011,-7.380, 0.251, 3.737,-1.4118,0.783,0.794),
c("GO:0048588","developmental cell growth", 0.012,-4.263, 3.365, 3.767,-1.4059,0.765,0.795),
c("GO:0006897","endocytosis", 0.200, 1.194,-2.786, 4.998,-3.3936,0.905,0.797),
c("GO:0007399","nervous system development", 0.120,-4.138, 3.125, 4.777,-1.9421,0.729,0.797),
c("GO:0048646","anatomical structure formation involved in morphogenesis", 0.131,-3.629, 2.928, 4.815,-4.2874,0.819,0.797),
c("GO:0051270","regulation of cellular component movement", 0.044, 0.156,-7.475, 4.343,-5.7645,0.769,0.799),
c("GO:0044248","cellular catabolic process", 7.945, 2.257, 4.362, 6.597,-4.0414,0.886,0.800),
c("GO:1902589","single-organism organelle organization", 0.635,-7.790, 0.845, 5.500,-5.9957,0.738,0.802),
c("GO:0010769","regulation of cell morphogenesis involved in differentiation", 0.015,-6.264,-2.186, 3.862,-3.1079,0.621,0.805),
c("GO:0030334","regulation of cell migration", 0.033, 0.467,-7.698, 4.212,-5.0830,0.737,0.812),
c("GO:0070252","actin-mediated cell contraction", 0.003,-0.742,-1.361, 3.171,-2.2573,0.879,0.812),
c("GO:0010770","positive regulation of cell morphogenesis involved in differentiation", 0.003,-6.256,-2.213, 3.209,-2.9394,0.626,0.814),
c("GO:0046365","monosaccharide catabolic process", 0.553, 2.927, 5.187, 5.439,-2.5847,0.848,0.815),
c("GO:0014910","regulation of smooth muscle cell migration", 0.002, 0.393,-7.072, 2.875,-2.0146,0.775,0.817),
c("GO:0071363","cellular response to growth factor stimulus", 0.030, 2.523,-4.243, 4.180,-2.2085,0.868,0.818),
c("GO:0043043","peptide biosynthetic process", 0.209, 2.792, 3.588, 5.017,-13.4634,0.907,0.819),
c("GO:0070848","response to growth factor", 0.031, 2.495,-4.109, 4.191,-2.0284,0.892,0.820),
c("GO:0070527","platelet aggregation", 0.002,-0.706,-5.722, 3.094,-9.9208,0.702,0.822),
c("GO:0048468","cell development", 0.132,-3.757, 3.352, 4.818,-5.0429,0.741,0.823),
c("GO:0002064","epithelial cell development", 0.015,-3.655, 2.963, 3.865,-3.3335,0.751,0.828),
c("GO:0006888","ER to Golgi vesicle-mediated transport", 0.019, 1.033,-3.036, 3.984,-4.0292,0.831,0.828),
c("GO:0030048","actin filament-based movement", 0.005,-0.279,-0.911, 3.365,-3.6596,0.876,0.833),
c("GO:0019439","aromatic compound catabolic process", 6.316, 3.528, 5.220, 6.497,-7.1993,0.868,0.834),
c("GO:0019083","viral transcription", 0.064, 2.726, 2.938, 4.506,-10.7399,0.862,0.835),
c("GO:0031334","positive regulation of protein complex assembly", 0.015,-6.414,-4.243, 3.887,-1.4767,0.713,0.838),
c("GO:0046700","heterocycle catabolic process", 6.219, 3.088, 4.606, 6.490,-6.7595,0.867,0.842),
c("GO:0044270","cellular nitrogen compound catabolic process", 6.232, 3.737, 5.551, 6.491,-6.6326,0.864,0.842),
c("GO:0070925","organelle assembly", 0.269,-7.524, 0.251, 5.127,-4.4295,0.774,0.844),
c("GO:0043085","positive regulation of catalytic activity", 0.209,-1.047,-7.596, 5.017,-1.4153,0.854,0.847),
c("GO:0034613","cellular protein localization", 0.670, 0.927,-2.767, 5.523,-15.9957,0.823,0.849),
c("GO:0070727","cellular macromolecule localization", 0.671, 1.156,-3.451, 5.523,-15.8633,0.838,0.849),
c("GO:0014706","striated muscle tissue development", 0.023,-3.570, 2.918, 4.058,-1.9912,0.822,0.852),
c("GO:0006518","peptide metabolic process", 0.323, 2.425, 3.138, 5.206,-11.3298,0.912,0.852),
c("GO:0006757","ADP phosphorylation", 0.000, 3.528, 2.499, 1.531,-4.2097,0.875,0.852),
c("GO:0006094","gluconeogenesis", 0.274, 2.076, 3.072, 5.134,-3.0283,0.874,0.852),
c("GO:0060537","muscle tissue development", 0.024,-3.960, 3.298, 4.080,-1.8310,0.823,0.854),
c("GO:0050900","leukocyte migration", 0.014, 2.134,-3.303, 3.828,-3.1618,0.787,0.859),
c("GO:0016477","cell migration", 0.069, 1.135,-2.528, 4.538,-8.6198,0.802,0.859),
c("GO:0031175","neuron projection development", 0.043,-6.680, 1.514, 4.329,-5.1124,0.598,0.862),
c("GO:0044419","interspecies interaction between organisms", 1.784, 0.284, 1.076, 5.948,-17.1415,0.937,0.863),
c("GO:1901701","cellular response to oxygen-containing compound", 0.232, 2.940,-5.179, 5.062,-1.3743,0.862,0.864),
c("GO:0034446","substrate adhesion-dependent cell spreading", 0.004,-6.845, 1.193, 3.276,-1.9964,0.653,0.866),
c("GO:1900084","regulation of peptidyl-tyrosine autophosphorylation", 0.000, 1.656,-4.861, 1.954,-1.6392,0.857,0.870),
c("GO:0048675","axon extension", 0.005,-6.611, 1.553, 3.430,-1.4796,0.633,0.871),
c("GO:0033365","protein localization to organelle", 0.169, 1.052,-3.332, 4.925,-10.0472,0.839,0.873),
c("GO:0030855","epithelial cell differentiation", 0.036,-3.747, 3.119, 4.258,-2.5951,0.747,0.878),
c("GO:0051649","establishment of localization in cell", 1.489, 0.937,-2.710, 5.870,-11.7878,0.838,0.878),
c("GO:0006006","glucose metabolic process", 0.741, 1.585, 2.535, 5.567,-1.8841,0.876,0.879),
c("GO:0006898","receptor-mediated endocytosis", 0.166, 1.187,-2.753, 4.917,-1.6985,0.906,0.880),
c("GO:0072659","protein localization to plasma membrane", 0.008,-6.181,-1.648, 3.602,-3.4034,0.700,0.881),
c("GO:0022617","extracellular matrix disassembly", 0.001,-7.544, 0.441, 2.867,-1.8329,0.818,0.881),
c("GO:0044764","multi-organism cellular process", 2.058, 0.088, 1.273, 6.010,-17.0660,0.907,0.881),
c("GO:0044724","single-organism carbohydrate catabolic process", 1.202, 3.165, 5.421, 5.777,-2.1985,0.845,0.883),
c("GO:0010811","positive regulation of cell-substrate adhesion", 0.005,-1.392,-6.348, 3.428,-3.6162,0.834,0.884),
c("GO:0006461","protein complex assembly", 0.564,-7.393, 0.164, 5.448,-4.8539,0.756,0.884),
c("GO:0010941","regulation of cell death", 0.137,-0.903,-7.056, 4.835,-3.0227,0.825,0.886),
c("GO:0048729","tissue morphogenesis", 0.042,-3.529, 2.894, 4.320,-2.5024,0.788,0.886),
c("GO:0046907","intracellular transport", 0.739, 1.089,-3.186, 5.566,-12.5186,0.846,0.887),
c("GO:0016358","dendrite development", 0.010,-6.980, 1.626, 3.704,-1.3907,0.627,0.888),
c("GO:0002504","antigen processing and presentation of peptide or polysaccharide antigen via MHC class II", 0.053, 0.172, 0.162, 4.420,-2.2821,0.954,0.888),
c("GO:0030433","ER-associated ubiquitin-dependent protein catabolic process", 0.003, 5.210,-1.092, 3.128,-1.3973,0.792,0.888),
c("GO:0006096","glycolytic process", 0.522, 4.261, 4.366, 5.414,-4.2573,0.753,0.889),
c("GO:0046718","viral entry into host cell", 0.797, 0.909,-0.693, 5.598,-2.7068,0.850,0.891),
c("GO:0046034","ATP metabolic process", 5.374, 4.239, 3.998, 6.427,-1.7380,0.790,0.892),
c("GO:0002474","antigen processing and presentation of peptide antigen via MHC class I", 0.060, 0.236, 0.227, 4.476,-1.7477,0.953,0.895),
c("GO:0016337","single organismal cell-cell adhesion", 0.020,-0.952,-0.910, 3.989,-6.7122,0.914,0.897),
c("GO:0002009","morphogenesis of an epithelium", 0.034,-4.001, 3.327, 4.227,-1.7536,0.789,0.899));
one.data <- data.frame(revigo.data);
names(one.data) <- revigo.names;
one.data <- one.data [(one.data$plot_X != "null" & one.data$plot_Y != "null"), ];
one.data$plot_X <- as.numeric( as.character(one.data$plot_X) );
one.data$plot_Y <- as.numeric( as.character(one.data$plot_Y) );
one.data$plot_size <- as.numeric( as.character(one.data$plot_size) );
one.data$log10_p_value <- as.numeric( as.character(one.data$log10_p_value) );
one.data$frequency <- as.numeric( as.character(one.data$frequency) );
one.data$uniqueness <- as.numeric( as.character(one.data$uniqueness) );
one.data$dispensability <- as.numeric( as.character(one.data$dispensability) );
#head(one.data);
# --------------------------------------------------------------------------
# Names of the axes, sizes of the numbers and letters, names of the columns,
# etc. can be changed below
p1 <- ggplot( data = one.data );
p1 <- p1 + geom_point( aes( plot_X, plot_Y, colour = log10_p_value, size = plot_size), alpha = I(0.6) ) + scale_size_area();
p1 <- p1 + scale_colour_gradientn( colours = c("blue", "green", "yellow", "red"), limits = c( min(one.data$log10_p_value), 0) );
p1 <- p1 + geom_point( aes(plot_X, plot_Y, size = plot_size), shape = 21, fill = "transparent", colour = I (alpha ("black", 0.6) )) + scale_size_area();
p1 <- p1 + scale_size( range=c(5, 30)) + theme_bw(); # + scale_fill_gradientn(colours = heat_hcl(7), limits = c(-300, 0) );
ex <- one.data [ one.data$dispensability < 0.15, ];
p1 <- p1 + geom_text( data = ex, aes(plot_X, plot_Y, label = description), colour = I(alpha("black", 0.85)), size = 3 );
p1 <- p1 + labs (y = "semantic space x", x = "semantic space y");
p1 <- p1 + theme(legend.key = element_blank()) ;
one.x_range = max(one.data$plot_X) - min(one.data$plot_X);
one.y_range = max(one.data$plot_Y) - min(one.data$plot_Y);
p1 <- p1 + xlim(min(one.data$plot_X)-one.x_range/10,max(one.data$plot_X)+one.x_range/10);
p1 <- p1 + ylim(min(one.data$plot_Y)-one.y_range/10,max(one.data$plot_Y)+one.y_range/10);
# --------------------------------------------------------------------------
# Output the plot to screen
p1;
# Uncomment the line below to also save the plot to a file.
# The file type depends on the extension (default=pdf).
# ggsave("C:/Users/path_to_your_file/revigo-plot.pdf");
library(GO.db)
head(GOBPANCESTOR)
GOMFPARENTS$"GO:0003700"
GOMFPARENTS$"GO:0003700"
GOBPPARENTS$"GO:0003700"
GOBPPARENTS$"GO:0003700"
GOMFPARENTS$"GO:0003700"
GOMFCHILDREN$"GO:0001071"
GOBPANCESTOR$"GO:0003700"
GOMFANCESTOR$"GO:0003700"
GOMFCHILDREN$"GO:0001071"
GOMFOFFSPRING$"GO:0001071"
GOTERM$"GO:0003700"
class(GOTERM$"GO:0003700")
names(GOTERM$"GO:0003700")
xx <- as.list(GOTERM)
xx[[1]]
if(length(xx) > 0){
# Get the TERMS for the first elent of xx
GOID(xx[[1]])
Ontology(xx[[1]])
}
Ontology("GO:0003700")
GOID(xx[[1]])
GOTERM$"GO:0003700"
GOID("transcription factor activity, sequence-specific DNA binding")
GOID("GO:0003700")
xx[[3700]]
names(xx)
which(names(xx) == "GO:0003700")
xx[[2693]]
which(names(xx) == "GO:0003700")
head(GOBPANCESTOR)
xx[[2693]]
GOID("GO:0003700")
Ontology("GO:0003700")
GOID(xx[[2693]])
GOMFANCESTOR$"GO:0003700"
GOMFPARENTS$"GO:0003700"
GOMFCHILDREN$"GO:0001071"
GOMFCHILDREN$"GO:0003700"
GOMFOFFSPRING$"GO:0003700"
GOSYNONYM$"GO:0003700"
head(GOSYNONYM)
GOSYNONYM
GOMFANCESTOR$"GO:0001071"
GOMFPARENTS$"GO:0001071"
GOMFCHILDREN$"GO:0001071"
GOMFOFFSPRING$"GO:0001071"
GO_dbconn()
GO_dbfile()
GO_dbInfo()
sample(GOSYNONYM, 3)
GOSYNONYM$`GO:0030615`
GOSYNONYM$'GO:0030615'
GOSYNONYM$'GO:0000922'
CalStat2 <- function(dat, colName, pval=0.05){
# Permutation Test
dat$pvalSign <- apply(dat[,colName], 1, CalPval)
# Pvalue
dat <- dat %>%
select(GeneSet, Sample, Type1, Type2, pvalSign) %>%
mutate(
pvalUnsign = abs(pvalSign),
pvalAdj    = p.adjust(pvalUnsign, "BH"),
Sigf       = pvalUnsign < pval,
SigfAdj    = pvalAdj    < pval)
} # end func CalStat2
CalStat2 <- function(dat, colName, pval=0.05){
# Permutation Test
dat$pvalSign <- apply(dat[,colName], 1, CalPval)
# Pvalue
dat <- dat %>%
select(GeneSet, Sample, pvalSign) %>%
mutate(
pvalUnsign = abs(pvalSign),
pvalAdj    = p.adjust(pvalUnsign, "BH"),
Sigf       = pvalUnsign < pval,
SigfAdj    = pvalAdj    < pval)
} # end func CalStat2
CalStat2 <- function(dat, colName, pval=0.05){
# Permutation Test
dat$pvalSign <- apply(dat[,colName], 1, CalPval)
# Pvalue
dat <- dat %>%
select(GeneSet, Sample, pvalSign) %>%
mutate(
pvalUnsign = abs(pvalSign),
pvalAdj    = p.adjust(pvalUnsign, "BH"),
Sigf       = pvalUnsign < pval,
SigfAdj    = pvalAdj    < pval)
} # end func CalStat2
CalPeak <- function(dat, colName){
dat$Peak <- apply(dat[,colName], 1, FindPeak)
dat <- dat %>% as.data.frame %>%
select(GeneSet, GeneSetName, Peak) %>%
arrange(desc(Peak)) %>%
distinct
workdir <- "C:\\Users\\clint\\Documents\\GitHub\\BlogDataAnalysis"
setwd(workdir)
filePathData <- file.path(workdir,"Data","StatCompEcology","Copepod")
cPodDensity <- read.table("cop_density.txt",         header=T)
filePathData <- file.path(workdir,"Data","StatCompEcology","Copepod")
cPodDensity <- read.table(file.path(
filePathData, "cop_density.txt"),
header=T)
cPodCompose <- read.table(file.path(
filePathData, "copepod_composition.txt"),
header=T)

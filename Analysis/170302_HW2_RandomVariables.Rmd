---
title: "Exercise of Random Variables"
author: "Kuei Yueh Ko"
date: "2017/3/2"
output: html_document
---

1. Random Numbers Generation 
    - a. Generate 10000 random numbers from Gaussian distribution with mean=20 and variance =10, and plot the distribution. 
    - b. Generate 10000 random numbers from Binomial distribution with p=0.5 and n=40, and plot the distribution. 
    - c. Compare the distribution of 1a and 1b, what do you find? (hint: you can use “rand” and “randn” in matlab. Or, “runif” and “rnorm” in R) 

2. Make a program that can select our candidates for 
presentation next week.  This program should select 
randomly but avoid selecting the numbers that had 
been selected before.  
    - (hint: uniform distribution, loop, and if statements.) 

# Prepare the function
create my function to generator of bernoulli random variable
```{r}
myGauss <- function(n, mu, sigma2){
    x <- rnorm(n)
    y <- x * (sigma2^0.5) + mu
    return(y)
}

myUnif <- function(n, a=0, b=1) {
    x <- runif(n)
    y <- x * (b-a) + a
    return(y)
} # end func myUnif

myBern  <- function(n, prob=0.5){
    res <- ifelse(runif(n) <= prob, 1, 0)
    return(res)
} # end func myBern

myBinom <- function(n, size, prob=0.5){
    res <- replicate(n, sum(myBern(size, prob)))
    return(res)
} # end func myBinom
```

```{r}
plotMatrix <- function(dat, isXlab=T, isYlab=T){
    # given a data (matrix or dataframe), plot the
    # value of each element as color
    # ---------------------------------
    # Set color scale
    colPalette.WR <- colorRampPalette(c(
        "#fef0d9", "#fdbb84", "#fc8d59", "#e34a33"))(256)
    
    # Flipping the matrix
    mat <- as.matrix(dat)
    mat <- t(mat)
    mat <- mat[,ncol(mat):1,drop=FALSE]
    
    # Plot the matrix
    image(mat, xaxt= "n", yaxt= "n",
          col = colPalette.WR)
    
    # Show ticks if needed
    if(isXlab){ # if X ticks are added
        axis(1, at=seq(0,1,length.out=ncol(dat)), 
             labels=colnames(dat), las=1)
    } # end if
    if(isYlab){ # if Y ticks are added
        axis(2, at=seq(0,1,length.out=nrow(dat)), 
             labels=rev(rownames(dat)), las=2)
    } # end if
} # end func plotMatrix
```

# 1a Generate 10000 random numbers from Gaussian distribution with mean=20 and variance =10, and plot the distribution

```{r}
#
N <- 10000

#
x <- myGauss(N, 0,   1)
y <- myGauss(N, 10, 10)
```


```{r}
#
gp1 <- hist(x)
gp2 <- hist(y)
plot(gp1, col=rgb(0,0,1,1/4), 
     xlim=c(-10, 20), 
     ylim=c(  0, N/3))
plot(gp2, col=rgb(1,0,0,1/4), add=T)
```


# 1b. Generate 10000 random numbers from Binomial distribution with p=0.5 and n=40, and plot the distribution. 
Bernoulli distribution
```{r}
# length of number generated 
#N <- 10000

#
#x <- myBern(N, 0.8)

# summarize the result (freq of 1 and 0)
#res <- table(x) / N

# barplot
#gp <- barplot(res, ylim=c(0,1))
#axis(side=1, lwd = 2, at=gp, labels=c(0,1))
#axis(side=2, lwd = 2)
```

generate binomial distribution, which is the sum of bernoulli random variable
```{r}
N <- 10000
x <- myBinom(N, 40)
hist(x, xlim=c(0, 40))
axis(side=1, lwd = 2)
axis(side=2, lwd = 2)
```

# 1c. Compare the distribution of 1a and 1b, what do you find? (hint: you can use “rand” and “randn” in matlab. Or, “runif” and “rnorm” in R)

```{r}
N     <- c(10, 50, 100, 1000)
Nchar <- as.character(N)

listBinom <- list()
listGauss <- list()

for (idx in 1:length(N)){
    listBinom[[Nchar[idx]]] <- 
        myBinom(N[idx], size=40, prob=0.5)
    listGauss[[Nchar[idx]]] <- 
        myGauss(N[idx], mean(x), var(x))
} # end for loop
```

plot the result
```{r}
par(mfrow=c(2,4))
for (idx in Nchar){
    hist(listBinom[[idx]], 
        col = "#b3cde3",
        main=paste0("Binomial Distr.\nN=", idx),
        xlab = "Value")
} # end for loop

for (idx in Nchar){
    hist(listGauss[[idx]], 
        col = "#fbb4ae",
        main=paste0("Gauss Distr.\nN=", idx),
        xlab = "Value")
} # end for loop

```

# 2. Make a program that can select our candidates for presentation next week. This program should select randomly but avoid selecting the numbers that had been selected before. (hint: uniform distribution, loop, and if statements.) 

```{r}
Get2NumRand <- function(ids){
    idx <- myUnif(1, 0, length(ids))
    idx <- ceiling(idx)
    id01 <- ids[idx]
    
    ids <- setdiff(ids, id01)

    idx <- myUnif(1, 0, length(ids))
    idx <- ceiling(idx)
    id02 <- ids[idx]
    return(c(id01, id02))
} # end func 
```


```{r}
N   <- 10000
ids <- 1:18
res <- replicate(N, Get2NumRand(ids))
mat <- matrix(0, nrow=length(ids), ncol=length(ids))
for (idx in 1:N){
    mat[res[1,idx], res[2,idx]] <- 
        mat[res[1,idx], res[2,idx]] + 1
}
mat[1:6, 1:6]
```

```{r}
par(mfrow=c(1,3), 
    #mar=c(5.1,4.1,4.1,2.1))
    mar=c(8,4.1,8,1))

barplot(table(res[1,]) / N, 
        main="First Student", 
        ylim=c(0,0.1))

barplot(table(res[2,]) / N, 
        main="Second Student", 
        ylim=c(0,0.1))

plotMatrix(mat, isXlab = F, isYlab = F)
title(
    main="student selection",
    xlab="Second Student",
    ylab="First Student")
```


